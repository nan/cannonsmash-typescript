# プレイヤータイプ仕様

各プレイヤータイプは、移動速度、加速度、スイングの優先順位に加え、**打球の威力（スピード、回転、精度）**によって差別化されています。

## 基本ステータス

| プレイヤータイプ | 名称 | 移動速度 (Run Speed) | 加速度 (Acceleration) | スイング選択優先順位 (条件付き) |
| :--- | :--- | :--- | :--- | :--- |
| **Pen Attack** | ペンホルダー速攻型 | 1.2 | 1.3 | **スマッシュ** > ドライブ > ツッツキ |
| **Shake Defence** | シェークハンド守備型 | 1.0| 1.0 | **カット** > ツッツキ > ブロック |
| **Shake Drive** | シェークハンドドライブ型 | 1.0 | 1.0 | **ドライブ** > スマッシュ > ツッツキ |
| **Pen Drive** | ペンホルダー・ドライブ型 | 1.3 | 1.1 | **ドライブ** > スマッシュ > ツッツキ |

## 打球威力 (Shot Stats)

各プレイヤーは、スイングの種類（フォア/バック × スイングタイプ）ごとに以下の3つのパラメータを持っています。

*   **Speed (速度倍率)**: そのスイングにおける最高速度に対する倍率。
*   **Spin (回転倍率)**: そのスイングの基準回転量に対する倍率。
*   **Precision (精度)**: 打球の誤差（値が小さいほど正確）。

### 打球速度の決定ロジック

打球速度は以下のロジックで決定されます。

1.  **スイングごとの最高速度 (Base Max Speed)**
    スイングの種類ごとに、物理的な最高速度が定義されています。
    *   F_SMASH: 30.0 m/s
    *   F_DRIVE: 25.0 m/s
    *   F_NORMAL: 20.0 m/s
    *   ...など

2.  **プレイヤーごとの最高速度 (Player Max Speed)**
    `Base Max Speed` に、そのプレイヤーの `Speed` ステータスを掛け合わせます。
    > **Player Max Speed = Base Max Speed × Player Speed Stat**

    *   例: Pen Drive (Speed 1.2) が F_DRIVE (25.0 m/s) を打つ場合
        *   25.0 × 1.2 = **30.0 m/s** がこのプレイヤーのドライブの限界速度となります。

3.  **軌道計算**
    この `Player Max Speed` を上限として、ターゲットに着弾する最適な軌道を計算します。
    *   `Speed` ステータスが **1.0を超える** プレイヤーは、標準よりも速い限界速度を持つため、より鋭く、決定力の高いボールを打つことができます。
    *   逆に `Speed` が低いプレイヤーは、限界速度が低くなるため、山なりのボールになりがちです。

4.  **打球強度 (Shot Strength)**
    プレイヤーが意図的に力を抑えて打つ場合（`intendedShotStrength < 1.0`）、その割合で速度が減少します。

### 詳細データ

#### Pen Attack (ペンホルダー速攻型)
*   **特徴**: スマッシュが非常に強力で、フォアハンド全般が高性能。
*   **F_SMASH**: Speed 1.5, Precision 0.10
*   **F_DRIVE**: Speed 0.8, Precision 0.10 (ドライブは繋ぎ)

#### Shake Defence (シェークハンド守備型)
*   **特徴**: 守備的技術（カット、ブロック）の精度と回転量が非常に高い。攻撃力は低い。
*   **F/B_CUT**: Speed 0.7, Precision 0.05 (非常に正確), Spin 1.5 (強烈な下回転)
*   **Smash/Drive**: Speed 0.6~0.7 (決定打に欠ける)

#### Shake Drive (シェークハンドドライブ型)
*   **特徴**: フォア、バック共にバランス良く強力なドライブが打てる。
*   **F/B_DRIVE**: Speed 1.2, Precision 0.10, Spin 1.2
*   **Smash**: Speed 1.1 (スマッシュもそこそこ速い)

#### Pen Drive (ペンホルダー・ドライブ型)
*   **特徴**: フォアハンドドライブの威力が全タイプ中最強。バックハンドは弱点。
*   **F_DRIVE**: Speed 1.4, Precision 0.05, Spin 1.4 (一撃必殺のドライブ)
*   **B_DRIVE**: Speed 0.6 (バックは苦手)

## スイング決定ロジック

AIのスイングは、以下の2段階のプロセスで決定されます。

### 1. 物理的な実行可能性の判定 (Valid Swings)
ボールの位置、高さ、速度に基づいて、物理的に打球可能なスイングの種類（候補）を特定します。これは**全プレイヤータイプ共通**のロジックです。

![Valid Swings Diagram](valid_swings_diagram.png)

*   **High Area**: スマッシュ、ドライブ
*   **Near Low Area**: ツッツキ、Normal
*   **Near Middle Area**: ツッツキ、ドライブ、Normal
*   **Far Middle Area**: カット、ドライブ、Normal
*   **Far Low Area**: カット、ドライブ、Normal

### 2. 優先順位による選択 (Deterministic Selection)
特定された候補の中から、**プレイヤータイプごとの優先順位**に従って、最も優先度の高いスイングを選択します。

*   例: **Pen Attack** の場合
    1.  候補に **スマッシュ** があれば、即座に選択。
    2.  なければ、候補に **ドライブ** があれば選択。
    3.  それもなければ、**ツッツキ** を選択。


## 打球威力ステータス詳細 (Shot Power Table)

各プレイヤータイプのスイングごとのステータス倍率は以下の通りです。
`Speed` は `Player Max Speed` の計算に使用され、`Spin` は回転量、`Precision` は誤差（低いほど良い）に影響します。

| Player Type | Swing | Speed | Precision | Spin |
| :--- | :--- | :--- | :--- | :--- |
| **Pen Attack** | F_NORMAL | 1.0 | 0.10 | 1.0 |
| | F_DRIVE | 0.8 | 0.10 | 0.9 |
| | F_SMASH | 1.5 | 0.10 | 1.0 |
| | F_POKE | 1.0 | 0.10 | 1.2 |
| | F_CUT | 0.7 | 0.20 | 0.6 |
| | B_NORMAL | 1.0 | 0.10 | 1.0 |
| | B_DRIVE | 0.7 | 0.15 | 0.7 |
| | B_SMASH | 1.4 | 0.10 | 1.0 |
| | B_POKE | 1.0 | 0.10 | 1.2 |
| | B_CUT | 0.7 | 0.20 | 0.6 |
| **Shake Defence** | F_NORMAL | 1.0 | 0.10 | 1.0 |
| | F_DRIVE | 0.8 | 0.15 | 1.0 |
| | F_SMASH | 0.9 | 0.20 | 1.0 |
| | F_POKE | 1.0 | 0.10 | 1.4 |
| | F_CUT | 1.0 | 0.10 | 1.5 |
| | B_NORMAL | 1.0 | 0.10 | 1.0 |
| | B_DRIVE | 0.8 | 0.10 | 0.8 |
| | B_SMASH | 0.9 | 0.15 | 1.0 |
| | B_POKE | 1.0 | 0.10 | 1.4 |
| | B_CUT | 1.0 | 0.10 | 1.4 |
| **Shake Drive** | F_NORMAL | 1.0 | 0.10 | 1.0 |
| | F_DRIVE | 1.2 | 0.10 | 1.4 |
| | F_SMASH | 1.1 | 0.20 | 1.0 |
| | F_POKE | 1.0 | 0.20 | 0.9 |
| | F_CUT | 0.8 | 0.15 | 1.0 |
| | B_NORMAL | 1.0 | 0.10 | 1.0 |
| | B_DRIVE | 1.2 | 0.10 | 1.2 |
| | B_SMASH | 1.0 | 0.15 | 1.0 |
| | B_POKE | 1.0 | 0.20 | 0.9 |
| | B_CUT | 0.8 | 0.15 | 0.9 |
| **Pen Drive** | F_NORMAL | 1.0 | 0.10 | 1.0 |
| | F_DRIVE | 1.3 | 0.10 | 1.5 |
| | F_SMASH | 1.2 | 0.15 | 1.0 |
| | F_POKE | 1.0 | 0.15 | 1.1 |
| | F_CUT | 0.7 | 0.25 | 0.6 |
| | B_NORMAL | 0.8 | 0.20 | 1.0 |
| | B_DRIVE | 0.7 | 0.20 | 0.9 |
| | B_SMASH | 0.7 | 0.20 | 1.0 |
| | B_POKE | 1.0 | 0.15 | 1.1 |
| | B_CUT | 0.7 | 0.25 | 0.6 |

